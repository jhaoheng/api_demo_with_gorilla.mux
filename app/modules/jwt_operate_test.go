package modules

import (
	"fmt"
	"testing"
)

func Test_NewJWTSrv(t *testing.T) {
	pub_key := []byte(test_pub_key)
	pri_key := []byte(test_pri_key)
	jwtsrv, _ := NewJWTSrv(pub_key, pri_key)
	tokenSting := jwtsrv.Encrtpying("maxhu")

	if account, ok := jwtsrv.Validating(tokenSting); !ok {
		t.Fatal("fail")
	} else {
		fmt.Println(account)
	}
}

var (
	test_pub_key = `-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAqCYzn33tS4IJ4Yr/D8kX
DmF+6JimzZv9WdXc7ce7Fwr7wdYE22mrjRs6K0ZS4FFDrV8oE/oNapi9N3BOnYQa
UbZWW6lLN/PmygniMlq9OVCcxiqn5yk0c87IifzzVRqY9iuj2Gx+ZaGf2MGbt6Ih
631m3idjSalJffAJC38EMlkmPd8SHxqlENeV29VKGqY0wPvL0SVyGrIU2nNtbEHn
toSPik07rjeo4Gs0CeZtngxWRQdjywuVldTg6+2+PFublKeKHkLUu9JEMTjRGl33
K9ePX4hnlda/9yujeOjFD7mGF78GmPTgWFmunkiyWAC6PoKS9OALUGiIMi3TKCXq
N5u1xHZ7ap59pNa4HjyFxaeB8G6+oAgX6hnpCrC4qDLknrADwzFWbBO78EMeqUjj
I0K3Fdlm8RdsOGGd/+F3ryRr57pdKxwjIXPKdfQ30p9zT8gFgIObswEAqeranvix
mY6mV6ikkkSA5pmBAid26W6YN39EyeDgSG+aXWynXbw9JuhLzpqW998pKuaX8D6u
SjN8V+28E48Y66lgXfHbY/PYFDGOdBO8WwfVewuHEI9LiroaF5qKto6hnSoY/cxk
iiZzkcaMKe9OfwsshbF5DIe/lPKd+nOTdF96X+ZY2bbV3pfCfOJHOGd+7I7tYFWK
rx9nK0yKAKCY6ZriuwIJ2MUCAwEAAQ==
-----END PUBLIC KEY-----`

	test_pri_key = `-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`
)
